{% extends 'base/base.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/tasks_for_list.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock extra_css %}

{% block content %}
<div class="task-wrapper">
    <div class="task-header">
        <div class="search-container">  
            <form  method='GET'>
            <input type="text" class="search-input" name='search' placeholder="Search lists..." value='{{search_query}}'>  
            <button class="search-btn" type='submit' >  
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">  
                    <circle cx="11" cy="11" r="8"></circle>  
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>  
                </svg>  
            </button>  
        </form>
     
        </div>
            <div class="filter_priorities">
                <form method='GET'>
                    {% csrf_token %}
                    <label for="priorities">priorities</label>
                    <select name="filter" id='priorities'>
                        <option value="all">all</option>
                        <option value="low">low</option>
                        <option value="medium">medium</option>
                        <option value="high">high</option>
                    </select>
                    <button type='submit'>Go</button>
                </form> 
            </div>
        <a href="{% url 'add_task' list_id=list_id %}" class="btn add-task-btn">
            <i class="fas fa-plus"></i> Add New Task
        </a>
        <a href="{% url 'edit_todo_list' list_id %}">
            <i class="fa-solid fa-gear"></i>
        </a>
    </div>
    <table class="task-table">
        <thead>
            <tr>
                <th>Task</th>
                <th class="hide-on-mobile">priorities</th>
                <th>Status</th>
                <th>Due Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
                <tr class="task-row">
                    <td class="task-name">{{ task.title }}</td>
                    <td class="task-description hide-on-mobile">{{ task.priorities }}</td>
                    <td>
                        <span class="task-status status-{{ task.status|lower|slugify }}">
                            {{ task.get_status_display }}
                        </span>
                    </td>
                    <td class="task-due-date">{% if task.due_date %}{{ task.due_date|date:"M d, Y" }}{% else %}N/A{% endif %}</td>
                    <td class="task-controls">
                      
                      {% if task.status == 'not_started'%}
                      <form action="{% url 'change_task_status' task.task_id %}" method='POST'>  {{ edit_1 }}
                        {% csrf_token %}
                      <button class="btn btn-start" type='submit'>
                        <i class="fas fa-play"></i> Start
                    </button>
                </form>
                   
              
                       {% elif task.status == 'in_progress' %} 
                       <form action="{% url 'change_task_status' task.task_id %}" method='POST' >
                        {% csrf_token %}
                       <button class="btn btn-complete" type='submit'>
                        <i class="fas fa-check"></i> Complete
                    </button>
                </form>
                   
                    {% else %}
                    
                        
                       <button class="btn btn-restart" type='submit'>
                        <i class="fas fa-redo"></i> Restart
                    </button>
                </form>
                {% endif %}
                <form action="{% url 'remove_task' task.task_id %}" method='POST'>
                    {% csrf_token %}
                    <button class="btn btn-delete" type='submit'>
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </form>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5" class="no-tasks">No tasks available for this list.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock content %}



    